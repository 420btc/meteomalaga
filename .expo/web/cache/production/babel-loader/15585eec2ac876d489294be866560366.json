{"ast":null,"code":"import*as React from'react';import NavigationBuilderContext from\"./NavigationBuilderContext\";import useOnPreventRemove,{shouldPreventRemove}from\"./useOnPreventRemove\";export default function useOnAction(_ref){var router=_ref.router,getState=_ref.getState,setState=_ref.setState,key=_ref.key,actionListeners=_ref.actionListeners,beforeRemoveListeners=_ref.beforeRemoveListeners,routerConfigOptions=_ref.routerConfigOptions,emitter=_ref.emitter;var _React$useContext=React.useContext(NavigationBuilderContext),onActionParent=_React$useContext.onAction,onRouteFocusParent=_React$useContext.onRouteFocus,addListenerParent=_React$useContext.addListener,onDispatchAction=_React$useContext.onDispatchAction;var routerConfigOptionsRef=React.useRef(routerConfigOptions);React.useEffect(function(){routerConfigOptionsRef.current=routerConfigOptions;});var onAction=React.useCallback(function(action){var visitedNavigators=arguments.length>1&&arguments[1]!==undefined?arguments[1]:new Set();var state=getState();if(visitedNavigators.has(state.key)){return false;}visitedNavigators.add(state.key);if(typeof action.target!=='string'||action.target===state.key){var result=router.getStateForAction(state,action,routerConfigOptionsRef.current);result=result===null&&action.target===state.key?state:result;if(result!==null){onDispatchAction(action,state===result);if(state!==result){var isPrevented=shouldPreventRemove(emitter,beforeRemoveListeners,state.routes,result.routes,action);if(isPrevented){return true;}setState(result);}if(onRouteFocusParent!==undefined){var shouldFocus=router.shouldActionChangeFocus(action);if(shouldFocus&&key!==undefined){onRouteFocusParent(key);}}return true;}}if(onActionParent!==undefined){if(onActionParent(action,visitedNavigators)){return true;}}for(var i=actionListeners.length-1;i>=0;i--){var listener=actionListeners[i];if(listener(action,visitedNavigators)){return true;}}return false;},[actionListeners,beforeRemoveListeners,emitter,getState,key,onActionParent,onDispatchAction,onRouteFocusParent,router,setState]);useOnPreventRemove({getState:getState,emitter:emitter,beforeRemoveListeners:beforeRemoveListeners});React.useEffect(function(){return addListenerParent===null||addListenerParent===void 0?void 0:addListenerParent('action',onAction);},[addListenerParent,onAction]);return onAction;}","map":{"version":3,"names":["React","NavigationBuilderContext","useOnPreventRemove","shouldPreventRemove","useOnAction","_ref","router","getState","setState","key","actionListeners","beforeRemoveListeners","routerConfigOptions","emitter","_React$useContext","useContext","onActionParent","onAction","onRouteFocusParent","onRouteFocus","addListenerParent","addListener","onDispatchAction","routerConfigOptionsRef","useRef","useEffect","current","useCallback","action","visitedNavigators","arguments","length","undefined","Set","state","has","add","target","result","getStateForAction","isPrevented","routes","shouldFocus","shouldActionChangeFocus","i","listener"],"sources":["../../src/useOnAction.tsx"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}